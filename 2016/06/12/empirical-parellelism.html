<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/theme.js"></script>
<link href="/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/css/theme.css" rel="stylesheet" type="text/css">
<link href="/css/syntax.css" rel="stylesheet" type="text/css">



    <title>Third Bit: Parallelism in Open Source Projects</title>
  </head>
  <body>
    <div class="container-fluid">
  <div class="row-fluid">
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">Third Bit</a>
      </div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
          <li class="active visible-xs-block"><a href="/links/">Links</a></li>
          <li class="active"><a href="/about/">About</a></li>
          <li class="active"><a href="/talks/">Talks</a></li>
          <li class="active"><a href="/ideas/">Ideas</a></li>
          <li class="active"><a href="/reading/">Reading</a></li>
          <li class="active"><a href="/archive/">Archive</a></li>
          <li class="active"><a href="/teaching/"><em>How to Teach</em></a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li class="active"><a href="http://appear.in/gvwilson"><img src="/files/appear.in.svg" class="navbar-icon" /></a></li>
          <li class="active"><a href="https://github.com/gvwilson"><img src="/files/github.svg" class="navbar-icon" /></a></li>
          <li class="active"><a href="http://twitter.com/gvwilson"><img src="/files/twitter.svg" class="navbar-icon" /></a></li>
          <li class="active"><a href="/feed.xml"><img src="/files/rss.svg" class="navbar-icon" /></a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container container-left">
      <div class="row">
        <div class="col-md-3 hidden-xs">
          <div class="sidebar well">
  <h2>Links</h2>
<p><em><a href="http://software-carpentry.org">Software Carpentry</a></em></p>
<p><em><a href="http://aosabook.org">Architecture of Open Source Applications</a></em></p>
<p><em><a href="http://neverworkintheory.org">Never Work in Theory</a></em></p>
<p><em><a href="http://sensibleadventures.com">Sensible Adventures</a></em></p>
<p><a href="/cv/">CV</a></p>
<p><a href="/bib/">Bibliography</a></p>

  <h2>Favorites</h2>
  
  
  <p><a href="/2018/03/20/goodbye-jeff.html">Goodbye, Jeff</a></p>
  
  <p><a href="/2018/03/16/seven-ways.html">Seven Ways to Think Like a Programmer</a></p>
  
  <p><a href="/2018/03/13/base-case-for-empirical-software-engineering.html">A Base Case for Empirical Software Engineering Research</a></p>
  
  <p><a href="/2018/01/07/book-club.html">Book Club</a></p>
  
  <p><a href="/2017/12/21/talking-people-into-things.html">Ten Simple Rules for Talking People Into Things</a></p>
  
  <p><a href="/2017/11/05/for-everyone.html">Carpentry For Everyone</a></p>
  
  <p><a href="/2017/10/16/exercise-types.html">What Kinds of Exercises Do You Use to Teach Programming?</a></p>
  
  <p><a href="/2017/09/30/git-graphs-and-engineering.html">Git, Graphs, and Software Engineering</a></p>
  
  <p><a href="/2017/06/19/ten-rules-research-partner.html">Ten Simple Rules for Being a Good Research Partner</a></p>
  
  <p><a href="/2017/05/22/numerical-javascript.html">Numerical JavaScript</a></p>
  
  <p><a href="/2017/01/06/them-thats-got.html">Them That's Got</a></p>
  
  <p><a href="/2016/10/30/rules-for-teaching.html">Rules for Teaching</a></p>
  
  <p><a href="/2016/04/29/why-teachers-dont-collaborate.html">Why Teachers Don't Collaborate on Lesson Development</a></p>
  
  <p><a href="/2016/04/01/zen-and-the-art-of-assignment-operators.html">Zen and the Art of Assignment Operators</a></p>
  
  <p><a href="/2016/03/13/in-my-better-world.html">In My Better World</a></p>
  
  <p><a href="/2015/12/19/why-i-teach.html">Why I Teach (Revisited)</a></p>
  
  <p><a href="/2015/12/06/just-keep-swimming.html">Just Keep Swimming</a></p>
  
  <p><a href="/2015/11/29/exaptation.html">Exaptation and the Future of Software Engineering</a></p>
  
  <p><a href="/2015/11/09/daddy-why-dont-you-ever-laugh.html">Daddy, Why Don't You Ever Laugh?</a></p>
  
  <p><a href="/2015/09/22/dad.html">Goodbye, Dad</a></p>
  
  <p><a href="/2014/10/08/announcing-the-creation-of-the-software-carpentry-foundational.html">Announcing the Creation of the Software Carpentry Foundation</a></p>
  
  <p><a href="/2014/03/14/learning-at-scale.html">Is Learning at Scale Just Another Name for Ubiquitous Surveillance in the Classroom?</a></p>
  
  <p><a href="/2013/10/17/you-keep-using-that-word.html">You Keep Using That Word</a></p>
  
  <p><a href="/2013/02/11/correctness-isnt-compelling.html">Correctness Isn't Compelling</a></p>
  
  <p><a href="/2012/10/23/twenty-percent.html">Twenty Percent</a></p>
  
  <p><a href="/2012/06/29/those-who-ignore-history.html">That Seems Simple to Me</a></p>
  
  <p><a href="/2012/01/21/the-life-i-did-live-the-breath-i-breathed.html">We Have Nothing To Give Them</a></p>
  
</div>

        </div>
        <div class="col-md-9">
          <div class="article">
            <div class="well">
              <h1><a href="/2016/06/12/empirical-parellelism.html">Jun 12, 2016 - Parallelism in Open Source Projects</a></h1>
              <div class="post-content">
                <p>
  Marc Kiefer, Daniel Warzel, and Walter Tichy:
  "An Empirical Study on Parallelism in Modern Open-Source Projects".
  SEPS'15, October 2015, 
  <a href="https://ps.ipd.kit.edu/backend/index.php/veroeffentlichungen-details/items/3803.html">https://ps.ipd.kit.edu/backend/index.php/veroeffentlichungen-details/items/3803.html</a>.
</p>
<blockquote>
  <em>
    <p>
      We present an empirical study of 135 parallel open-source
      projects in Java, C# and C++ ranging from small (&lt;1000 lines
      of code) to very large (&gt;2M lines of code) codebases. We
      examine the projects to find out how language features,
      synchronization mechanisms, parallel data structures and
      libraries are used by developers to express parallelism. We also
      determine which common parallel patterns are used and how the
      implemented solutions compare to typical textbook advice.
    </p>
    <p>
      The results show that similar parallel constructs are used
      equally often across languages, but usage also heavily depends
      on how easy to use a certain language feature is. Patterns that
      do not map well to a language are much rarer compared to other
      languages. Bad practices are prevalent in hobby projects but
      also occur in larger projects.
    </p>
  </em>
</blockquote>
<p>
  I wrote my first parallel program in 1986 on an ICL DAP with 4096
  bit-serial processors.  I wrote my second in Occam the following
  spring for a 16-transputer machine, and spent the next ten years
  thinking, "There has to be a better way."  Two decades later, the
  answer to that is still, "Not yet," but in those years parallelism
  of various kinds has gone from esoteric to everyday.
</p>
<p>
  But how do we actually use it?  And how well?  To answer those
  questions, the authors of this paper explored open source programs
  written in several different languages.  Here are a few of their
  findings (the figures for Java are omitted, since those tables are
  larger than the ones for C# and C++ combined):
</p>
<table class="table table-striped">
  <tr>
    <th colspan="4">Use of High-Level Constructs</th>
    <th colspan="4">Use of Synchronization Primitives</th>
  </tr>
  <tr>
    <th>Language</th>
    <th>Feature</th>
    <th># projects</th>
    <th>% of total</th>
    <th>Language</th>
    <th>Feature</th>
    <th># projects</th>
    <th>% of total</th>
  </tr>
  <tr>
    <td>C#</td>
    <td>Task</td>
    <td>33</td>
    <td>73.33%</td>
    <td>C#</td>
    <td>lock()</td>
    <td>42</td>
    <td>93.33%</td>
  </tr>
  <tr>
    <td></td>
    <td>ThreadPool</td>
    <td>19</td>
    <td>42.22%</td>
    <td></td>
    <td>ManualResetEvent</td>
    <td>22</td>
    <td>48.89%</td>
  </tr>
  <tr>
    <td></td>
    <td>TaskScheduler</td>
    <td>10</td>
    <td>22.22%</td>
    <td></td>
    <td>Monitor</td>
    <td>17</td>
    <td>37.78%</td>
  </tr>
  <tr>
    <td></td>
    <td>Parallel.For</td>
    <td>8</td>
    <td>17.78%</td>
    <td></td>
    <td>AutoResetEvent</td>
    <td>16</td>
    <td>35.56%</td>
  </tr>
  <tr>
    <td></td>
    <td>BlockingCollection</td>
    <td>6</td>
    <td>13.33%</td>
    <td></td>
    <td>ReaderWriterLockSlim</td>
    <td>15</td>
    <td>33.33%</td>
  </tr>
  <tr>
    <td></td>
    <td>Parallel.ForEach</td>
    <td>6</td>
    <td>13.33%</td>
    <td></td>
    <td>WaitHandle</td>
    <td>13</td>
    <td>28.89%</td>
  </tr>
  <tr>
    <td></td>
    <td>TaskFactory</td>
    <td>5</td>
    <td>11.11%</td>
    <td></td>
    <td>EventWaitHandle</td>
    <td>10</td>
    <td>22.22%</td>
  </tr>
  <tr>
    <td></td>
    <td>Parallel.Invoke</td>
    <td>1</td>
    <td>2.22%</td>
    <td></td>
    <td>Mutex</td>
    <td>10</td>
    <td>22.22%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>ManualResetEventSlim</td>
    <td>8</td>
    <td>17.78%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>Barrier</td>
    <td>7</td>
    <td>15.56%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>Semaphore</td>
    <td>6</td>
    <td>13.33%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>SpinWait</td>
    <td>4</td>
    <td>8.89%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>CountdownEvent</td>
    <td>3</td>
    <td>6.67%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>ReaderWriterLock</td>
    <td>3</td>
    <td>6.67%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>SemaphoreSlim</td>
    <td>3</td>
    <td>6.67%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>MethodImplOptions Synchronized</td>
    <td>2</td>
    <td>4.44%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>Interlocked.MemoryBarrier</td>
    <td>1</td>
    <td>2,22%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>SpinLock</td>
    <td>0</td>
    <td>0.00%</td>
  </tr>
  <tr>
    <td>C++</td>
    <td>#pragma omp parallel for</td>
    <td>6</td>
    <td>13.64%</td>
    <td></td>
    <td>mutex</td>
    <td>39</td>
    <td>88.64%</td>
  </tr>
  <tr>
    <td></td>
    <td>future/promise</td>
    <td>3</td>
    <td>6.82%</td>
    <td></td>
    <td>condition variable</td>
    <td>28</td>
    <td>63.63%</td>
  </tr>
  <tr>
    <td></td>
    <td>#pragma omp parallel</td>
    <td>2</td>
    <td>4.55%</td>
    <td></td>
    <td>Semaphore</td>
    <td>18</td>
    <td>40.91%</td>
  </tr>
  <tr>
    <td></td>
    <td>packaged task</td>
    <td>0</td>
    <td>0.00%</td>
    <td></td>
    <td>CriticalSection</td>
    <td>17</td>
    <td>38.64%</td>
  </tr>
  <tr>
    <td></td>
    <td>shared future</td>
    <td>0</td>
    <td>0.00%</td>
    <td></td>
    <td>unique lock</td>
    <td>16</td>
    <td>36.36%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>lock guard</td>
    <td>12</td>
    <td>27.27%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>barrier</td>
    <td>5</td>
    <td>11.36%</td>
  </tr>
  <tr>
    <td colspan="4"></td>
    <td></td>
    <td>#pragma omp critical</td>
    <td>3</td>
    <td>6.82%</td>
  </tr>
</table>
<p>
  But these tables don't tell the most important parts of the story.
  For that, we have to look at patterns:
</p>
<table class="table table-striped">
  <tr>
    <td>Pattern</td>
    <td>Java</td>
    <td>C#</td>
    <td>C++</td>
  </tr>
  <tr>
    <td>Master-worker</td>
    <td>29</td>
    <td>23</td>
    <td>23</td>
  </tr>
  <tr>
    <td>Producer-consumer</td>
    <td>10</td>
    <td>5</td>
    <td>5</td>
  </tr>
  <tr>
    <td>Pipeline</td>
    <td>8</td>
    <td>9</td>
    <td>8</td>
  </tr>
  <tr>
    <td>Parallel Loop</td>
    <td>1</td>
    <td>8</td>
    <td>5</td>
  </tr>
  <tr>
    <td>Fork-join</td>
    <td>3</td>
    <td>1</td>
    <td>1</td>
  </tr>
</table>
<p>
  But the authors go even further
  and look at where programmers do things they shouldn't:
</p>
<ul>
  <li>
    "Smaller projects tend to reimplement slight variations of existing
    functionality, while projects with a larger codebase often reuse
    existing functionality and extend these classes via subclassing."
  </li>
  <li>
    "An exception is the master-worker pattern. It seems that it is
    such an intuitive pattern, that some developers seem to implement
    it by accident. Unexperienced developers just create threads and
    distribute their work to them. In larger projects comments and
    class naming suggests that they are aware of the master-worker
    pattern and implement it on purpose..."
  </li>
  <li>
    "Prime examples of bad pratice are the synchronized() and lock()
    features in Java and C#. Both language references strongly advise
    against locking on publicly accessible types or classes. Nevertheless
    this is what happens in most instances in both Java and C# regardless
    of the size of the project."
  </li>
</ul>
<p>
  It's easy to say this means we need better
  documentation&mdash;better, but wrong.  Just as you can't refactor
  your way to better security, you can't document your way to better
  usability.  Knowing what people use, how they use it, and how
  they <em>mis</em>-use it could and should inform the design of the
  next generation of parallel programming tools.  And if that's too
  optimistic, we can at least hope that it will give the builders of
  the next generation of program checking tools a larger list of
  things to look for...
</p>

                
<p align="center"><em>This post originally appeared at <a href="http://neverworkintheory.org/">It Will Never Work in Theory</a>.</em></p>

              </div>
            </div>
            <div class="pagination">
              
              <a class="btn btn-default" href="/2016/06/12/error-message-frequency.html" class="next">Newer</a>
              
              
              <a class="btn btn-default" href="/2016/06/10/superbug-in-education.html" class="previous">Older</a>
              
            </div>
            
            
            <div class="well">
              
              <div id="disqus_thread">
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
              </div>
              
            </div>
            
            
          </div>
        </div>
      </div>
    </div>
    
  <script type="text/javascript">
    var disqus_shortname = 'thirdbit';

    var disqus_config = function () {
        this.page.identifier = '2016-06-12-empirical-parellelism-html';
    };

   (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>


    <div class="container-fluid">
  <div class="row-fluid">
    <div class="span12 footer navbar-inverse navbar-fixed-bottom">
      <br/>
      <p class="copyright">
        &copy; 2018 Greg Wilson.
        All content made available under the <a href="/license/">Creative Commons - Attribution License</a>.
      </p>
    </div>
  </div>
</div>


  <script type="text/javascript">
    var disqus_shortname = 'thirdbit';

    var disqus_config = function () {
        this.page.identifier = '2016-06-12-empirical-parellelism-html';
    };

   (function () {
     var s = document.createElement('script'); s.async = true;
     s.type = 'text/javascript';
     s.src = '//' + disqus_shortname + '.disqus.com/count.js';
     (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
   }());
 </script>



  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-1301159-1', 'auto');
    ga('send', 'pageview');
  </script>



</body>
</html>

  </body>
</html>
